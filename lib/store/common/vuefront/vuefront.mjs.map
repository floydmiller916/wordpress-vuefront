{"version":3,"sources":["../../../../src/store/common/vuefront/vuefront.ts"],"names":["state","error","ssr","sidebar","sidebarCart","mutations","toggleSidebar","toggleSidebarCart","setResponseError","e","graphQLErrors","message","setError","payload","setSSR","getters","actions","vuefrontInit","dispatch","commit","$cookies","get","root","Promise","all","nuxtServerInit","nuxtClientInit","rootGetters","$router","beforeEach","to","from","next","path"],"mappings":"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","sourcesContent":["import { MutationTree, GetterTree, ActionTree } from \"vuex\";\r\nimport { RootState } from \"vuefront-store\";\r\nexport type State = {\r\n  error: boolean | string;\r\n  ssr: boolean;\r\n  sidebar: boolean;\r\n  sidebarCart: boolean;\r\n};\r\nexport const state: State = {\r\n  error: false,\r\n  ssr: false,\r\n  sidebar: false,\r\n  sidebarCart: false,\r\n};\r\n\r\nexport const mutations: MutationTree<State> = {\r\n  toggleSidebar(state) {\r\n    state.sidebar = !state.sidebar;\r\n  },\r\n  toggleSidebarCart(state) {\r\n    state.sidebarCart = !state.sidebarCart;\r\n  },\r\n  setResponseError(state, e) {\r\n    if (e.graphQLErrors && e.graphQLErrors.message) {\r\n      state.error = e.graphQLErrors.message;\r\n    } else if (e.graphQLErrors && typeof e.graphQLErrors[0] !== \"undefined\") {\r\n      state.error = e.graphQLErrors[0].message;\r\n    } else if (e.graphQLErrors) {\r\n      state.error = e.graphQLErrors;\r\n    } else {\r\n      state.error = e;\r\n    }\r\n  },\r\n  setError(state, payload) {\r\n    state.error = payload;\r\n  },\r\n  setSSR(state, payload) {\r\n    state.ssr = payload;\r\n  },\r\n};\r\n\r\nexport const getters: GetterTree<State, RootState> = {\r\n  sidebar(state) {\r\n    return state.sidebar;\r\n  },\r\n  sidebarCart(state) {\r\n    return state.sidebarCart;\r\n  },\r\n  error(state) {\r\n    return state.error;\r\n  },\r\n  ssr(state) {\r\n    return state.ssr;\r\n  },\r\n};\r\n\r\nexport const actions: ActionTree<State, RootState> = {\r\n  async vuefrontInit({ dispatch, commit }) {\r\n    if (this.$cookies.get(\"token\")) {\r\n      commit(\"common/customer/setToken\", this.$cookies.get(\"token\"), {\r\n        root: true,\r\n      });\r\n    }\r\n    await Promise.all([\r\n      dispatch(\"store/cart/load\", {}, { root: true }),\r\n      dispatch(\"common/language/load\", {}, { root: true }),\r\n      dispatch(\"common/customer/checkLogged\", {}, { root: true }),\r\n      dispatch(\"store/currency/load\", {}, { root: true }),\r\n    ]);\r\n\r\n    if (this.$cookies.get(\"mode\")) {\r\n      commit(\"store/category/setMode\", this.$cookies.get(\"mode\"), {\r\n        root: true,\r\n      });\r\n    }\r\n  },\r\n  async nuxtServerInit({ dispatch, commit }) {\r\n    await dispatch(\"vuefrontInit\");\r\n    commit(\"setSSR\", true);\r\n  },\r\n  async nuxtClientInit({ commit, dispatch, rootGetters }) {\r\n    this.$router.beforeEach((to, from, next) => {\r\n      if (to.path !== from.path && rootGetters[\"vuefront/sidebar\"]) {\r\n        commit(\"toggleSidebar\");\r\n      }\r\n      next();\r\n    });\r\n    if (!rootGetters[\"vuefront/ssr\"]) {\r\n      await dispatch(\"vuefrontInit\");\r\n    }\r\n  },\r\n};\r\n"],"file":"vuefront.mjs"}